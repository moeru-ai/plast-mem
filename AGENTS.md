# Plast Mem Development Context

## Project Overview

Plast Mem is an experimental llm memory layer for cyber waifu. The project is not yet stable, and limited documentation.

## How to Use This Documentation

When working on Plast Mem, follow this decision tree to navigate the codebase and make changes efficiently:

### 1. Starting a Task

**First, understand what type of change you're making:**
- Is it a refactor/new feature? → Check docs/ARCHITECTURE.md for design principles
- Is it a bug fix? → Read relevant crate README.md files
- Is it about FSRS/retrieval/review? → Start with docs/architecture/fsrs.md and the current flow in `crates/core/src/memory/episodic.rs` and `crates/worker/src/jobs/memory_review.rs`

### 2. Understanding Change Impact

**Before making changes, trace the impact:**

1. **Read the crate's README.md** to understand responsibilities
2. **Check docs/ARCHITECTURE.md** for layer dependencies
3. **Review docs/CHANGE_GUIDE.md** for similar past changes

### 3. Quick Component Summary

- **plast_mem_core**: Core structure, including Message and Memory (Episodic retrieval with FSRS re-ranking)
- **plast_mem_db_migration**: Database table migrations
- **plast_mem_db_schema**: Database table entities, generated by `sea-orm-cli`
- **plast_mem_llm**: Wrapped AI SDK
- **plast_mem_shared**: Reusable utilities
- **plast_mem_worker**: Background tasks worker (event segmentation + memory review job)
- **plast_mem**: Entry Program

## Key Runtime Flows

- **Memory retrieval**: `src/api/retrieve_memory.rs` → `EpisodicMemory::retrieve` in `crates/core/src/memory/episodic.rs`
- **FSRS review update**: retrieval enqueues `MemoryReviewJob`, processed in `crates/worker/src/jobs/memory_review.rs` (currently auto-GOOD review)

## Build and Test Commands

```bash
# Basic commands
cargo build
cargo test
cargo check
```
